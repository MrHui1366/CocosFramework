{"version":3,"sources":["CLoading.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\coffee_bean\\component","sourcesContent":["import { ETheme } from '../common/CEnum';\r\nimport { CBASE64 } from '../data/CBase64';\r\nimport { CUI } from '../utils/CUI';\r\nimport { angle_2_radius as angle_2_radian } from '../utils/CMath';\r\nimport { FONT_NORMAL } from '../common/CGlobal';\r\n\r\nconst { ccclass } = cc._decorator;\r\n\r\n/** 球的尺寸 ***/\r\nconst BALL_SIZE: number = 12;\r\n\r\n/*** 球的数量 ***/\r\nconst BALL_COUNT: number = 12;\r\n\r\n/** 小球初始偏移 ***/\r\nconst DISTANCE: number = 32;\r\n\r\n/** 移动用时 ***/\r\nconst MOVE_TIME: number = 1.0;\r\n\r\n/**\r\n * 全屏Loading遮罩\r\n * 使用方法\r\n *      CLoading.show(\"haha\",ETheme.DARK);\r\n *      CLoading.show();\r\n *      CLoading.hide();\r\n */\r\n@ccclass\r\nexport class CLoading {\r\n\r\n    /*** 界面 节点 ***/\r\n    private static _uinst: cc.Node = null;\r\n\r\n    /*** 小球容器 ***/\r\n    private static _ballContainer: cc.Node = null;\r\n\r\n    /*** 小球们 ***/\r\n    private static _balls: cc.Node[];\r\n\r\n    /*** 是否已经初始化 ***/\r\n    private static _hasInit: boolean = false;\r\n\r\n    /*** 文字标签 ***/\r\n    private static _label: cc.Node = null;\r\n\r\n    /**\r\n     * 隐藏Loading遮罩\r\n     */\r\n    public static hide (): void {\r\n        if ( this._uinst == null ) {\r\n            return;\r\n        }\r\n\r\n        // 激活显示\r\n        this._uinst.active = false;\r\n    }\r\n\r\n    /**\r\n     * 显示Loading 遮罩\r\n     * @param content 文字内容\r\n     * @param theme \r\n     */\r\n    public static show ( content: string = null, theme: ETheme = ETheme.DARK ): void {\r\n        if ( this._uinst == null ) {\r\n            this.create( content, theme );\r\n            return;\r\n        }\r\n\r\n        // 激活显示\r\n        this._uinst.active = true;\r\n        this._uinst.set_2_Top();\r\n        this.updateTheme( content, theme );\r\n    }\r\n\r\n    /*** 更新主题 ***/\r\n    private static updateTheme ( content: string = null, theme: ETheme = ETheme.DARK ): void {\r\n        this._uinst.color = theme == ETheme.DARK ? cc.Color.BLACK : cc.Color.WHITE;\r\n        for ( let i = 0; i < this._balls.length; i++ ) {\r\n            const element = this._balls[ i ];\r\n            element.color = theme == ETheme.DARK ? cc.Color.WHITE : cc.Color.BLACK;\r\n        }\r\n\r\n        if ( this._label == null ) {\r\n            this.createText( content, theme );\r\n        } else {\r\n            this._label.color = theme == ETheme.DARK ? cc.Color.WHITE : cc.Color.BLACK;\r\n            this._label.getComponent( cc.Label ).string = content;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 创建遮罩\r\n     * @param theme 主题\r\n     */\r\n    private static create ( content: string = null, theme: ETheme = ETheme.DARK ): void {\r\n        // 准备资源\r\n        let sp = CBASE64.createSpriteFrameFromBase64Img( CBASE64.RECT_SP );\r\n\r\n        // 创建背景\r\n        let [ ui, spback ] = CUI.createSpriteNode( \"UI_Loading\" );\r\n        this._uinst = ui;\r\n        this._uinst.setAnchorPoint( 0.5, 0.5 );\r\n        this._uinst.setContentSize( cc.winSize );\r\n        this._uinst.color = theme == ETheme.DARK ? cc.Color.BLACK : cc.Color.WHITE;\r\n        this._uinst.opacity = 153;\r\n\r\n        // 设置背景遮罩\r\n        spback.spriteFrame = sp;\r\n        spback.sizeMode = cc.Sprite.SizeMode.CUSTOM;\r\n\r\n        // 设置阻止层\r\n        this._uinst.addComponent( cc.BlockInputEvents );\r\n\r\n        // 创建文本\r\n        ( content != null ) && this.createText( content, theme );\r\n\r\n        // 创建球\r\n        this.createBall( theme );\r\n\r\n        // 添加到摄像机上\r\n        cc.Camera.main.node.addChild( this._uinst );\r\n    }\r\n\r\n\r\n    /**\r\n     * 创建文本\r\n     */\r\n    private static createText ( content: string, theme: ETheme ): void {\r\n        let [ node, label ] = CUI.createLabelNode( \"hint\" );\r\n        label.string = content;\r\n        label.fontSize = FONT_NORMAL;\r\n        node.color = ( theme == ETheme.DARK ? cc.Color.WHITE : cc.Color.BLACK ).setA( 0.5 );\r\n        node.y = 0 - DISTANCE * 2;\r\n        this._label = node;\r\n        this._uinst.addChild( node );\r\n    }\r\n\r\n    /**\r\n     * 创建小球\r\n     * 并设置运动\r\n     */\r\n    private static createBall ( theme: ETheme ): void {\r\n        this._ballContainer = new cc.Node( \"ballContainer\" );\r\n        this._uinst.addChild( this._ballContainer );\r\n        this._ballContainer.y = DISTANCE;\r\n\r\n        // 小球容器不断循环旋转\r\n        let rotation = cc.rotateBy( MOVE_TIME * 1.6, 360 ).repeatForever();\r\n        this._ballContainer.runAction( rotation );\r\n\r\n        // 小球数组\r\n        this._balls = new Array<cc.Node>( BALL_COUNT );\r\n\r\n\r\n        // 创建小球\r\n        for ( let i = 0; i < BALL_COUNT; i++ ) {\r\n            let radian = 360 / BALL_COUNT * i * angle_2_radian;\r\n            let radius = DISTANCE;\r\n            let pos = new cc.Vec2( Math.cos( radian ) * radius, Math.sin( radian ) * radius );\r\n\r\n            let [ node, sp ] = CUI.createSpriteNode( \"Ball\" + ( i + 1 ) );\r\n            sp.spriteFrame = CBASE64.createSpriteFrameFromBase64Img( CBASE64.BALL_SP );\r\n            sp.sizeMode = cc.Sprite.SizeMode.CUSTOM;\r\n            node.setContentSize( BALL_SIZE, BALL_SIZE );\r\n            node.setPosition( pos );\r\n            node.opacity = 153;\r\n            this._ballContainer.addChild( node );\r\n\r\n            // 设置运动\r\n            let moveBack = cc.moveTo( MOVE_TIME, pos ).easing( cc.easeBackOut() );\r\n            let moveCenter = cc.moveTo( MOVE_TIME * 2, 0, 0 ).easing( cc.easeCubicActionIn() );\r\n            let delay = cc.delayTime( MOVE_TIME );\r\n            let seq = cc.sequence( moveCenter, moveBack, delay ).repeatForever();\r\n            // 运行运动\r\n            node.runAction( seq );\r\n\r\n            this._balls[ i ] = node;\r\n        }\r\n    }\r\n}"]}